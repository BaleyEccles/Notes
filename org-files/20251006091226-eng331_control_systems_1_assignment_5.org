:PROPERTIES:
:ID:       4845e439-6804-4e2e-821c-ca470e9623e7
:END:
#+title: ENG331 - Control Systems 1 - Assignment 5
#+date: [2025-10-06 Mon 09:12]
#+AUTHOR: Baley Eccles - 652137
#+FILETAGS: :Assignment:UTAS:2025:
#+LATEX_HEADER: \usepackage[a4paper, margin=2cm]{geometry}
#+LATEX_HEADER_EXTRA: \usepackage{minted}
#+LATEX_HEADER_EXTRA: \usepackage{fontspec}
#+LATEX_HEADER_EXTRA: \setmonofont{Iosevka}
#+LATEX_HEADER_EXTRA: \setminted{fontsize=\small, frame=single, breaklines=true}
#+LATEX_HEADER_EXTRA: \usemintedstyle{emacs}
#+LATEX_HEADER_EXTRA: \usepackage{float}
#+LATEX_HEADER_EXTRA: \usepackage[final]{pdfpages}
#+LATEX_HEADER_EXTRA: \setlength{\parindent}{0pt}
#+LATEX_HEADER_EXTRA: \setlength{\parskip}{1em}

* Question 1
\begin{align*}
T(s) &= \frac{G(s)}{1 + G(s)H(s)} \\
T(s) &= \frac{\frac{K}{s(s + 2)(s + 5)}}{1 + \frac{K}{s(s + 2)(s + 5)}(s + a)} \\
T(s) &= \frac{K}{K \left(a + s\right) + s \left(s + 2\right) \left(s + 5\right)} \\
\\
K_p &= \lim_{s\rightarrow0}T(s) \\
K_p &= \lim_{s\rightarrow0}\frac{K}{K \left(a + s\right) + s \left(s + 2\right) \left(s + 5\right)} \\
K_p &= \frac{1}{a} \\
e_{step}(\infty) &= \frac{1}{1 + K_p} \\
e_{step}(\infty) &= \frac{1}{1 + \frac{1}{a}} \\
e_{step}(\infty) &= \frac{a}{a + 1} \\
\\
P_{e_{step}:a} &= \frac{a}{e_{step}(\infty)}\frac{\partial e_{step}(\infty)}{\partial a} \\
P_{e_{step}:a} &= \frac{a}{\frac{a}{a + 1}} \frac{1}{\left(a + 1\right)^{2}} \\
P_{e_{step}:a} &=\frac{1}{a + 1}
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q1
clc
clear
close all

if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  warning('off');
  pkg load symbolic
end

syms s K a

T = ((K)/(s*(s + 2)*(s + 5)))/(1 + (K)/(s*(s + 2)*(s + 5))*(s + a));
T = simplify(T);
latex(T)

K_p = subs(T, s, 0);
latex(K_p)

e_step = 1/(1 + K_p);
latex(simplify(e_step))

de_da = simplify(diff(e_step, a));
latex(de_da)
P = de_da*a/(a/(a + 1));
latex(P)

t = -1:0.1:10;

err = 1./(1 + 1./t);
figure;
plot(t, err);
xlabel('a');
ylabel('Steady state error');
grid on;
print -dpng 'ENG331_Assignment_5_Q1.png'
#+END_SRC

#+RESULTS:
: \frac{K}{K \left(a + s\right) + s \left(s + 2\right) \left(s + 5\right)}
: \frac{1}{a}
: \frac{a}{a + 1}
: \frac{1}{\left(a + 1\right)^{2}}
: \frac{1}{a + 1}

[[./ENG331_Assignment_5_Q1.png]]

* Question 2
With $H(s) = s + 1$, $G_1(s) = K_1$ and $G_2(s) = \frac{K_2}{s + 2}$.
\begin{align*}
E(s) &= R(s) - C(s)H(s) \\
C(s) &= D(s) G_2(s) + G_1(s) G_2(s) \left(- C(s) H(s) + R(s)\right) \\
\Rightarrow C(s) &= \frac{D(s) G_2(s)}{G_1(s) G_2(s) H(s) + 1} + \frac{G_1(s) G_2(s) R(s)}{G_1(s) G_2(s) H(s) + 1} \\
\frac{R(s) - E(s)}{H(s)} &= C(s) \\
\Rightarrow E(s) &= \frac{- D(s) G_2(s) H(s) + R(s)}{G_1(s) G_2(s) H(s) + 1} \\
\Rightarrow E(s) &= \frac{- D(s) K_{2} s - D(s) K_{2} + R(s) s + 2 R(s)}{K_{1} K_{2} s + K_{1} K_{2} + s + 2}
\end{align*}


#+BEGIN_SRC octave :exports none :results output :session Q2
clc
clear
close all

if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  warning('off');
  pkg load symbolic
end

syms s R C K_1 K_2 D E G_1 G_2 H

G_1 = K_1;
G_2 = K_2/(s + 2);

H = s + 1;

E_equ = R - C*H

C_equ = G_2*D + G_1*G_2*E_equ == C;
latex(C_equ)
C_equ = expand(solve(C_equ, C))
latex(C_equ)

E_equ = simplify(solve((R - E)/H == C_equ, E))
latex(E_equ)
 
#+END_SRC

#+RESULTS:
#+begin_example
E_equ = (sym) -C⋅(s + 1) + R
\frac{D K_{2}}{s + 2} + \frac{K_{1} K_{2} \left(- C \left(s + 1\right) + R\right)}{s + 2} = C
C_equ = (sym)

           D⋅K₂                     K₁⋅K₂⋅R        
  ─────────────────────── + ───────────────────────
  K₁⋅K₂⋅s + K₁⋅K₂ + s + 2   K₁⋅K₂⋅s + K₁⋅K₂ + s + 2
\frac{D K_{2}}{K_{1} K_{2} s + K_{1} K_{2} + s + 2} + \frac{K_{1} K_{2} R}{K_{1} K_{2} s + K_{1} K_{2} + s + 2}
E_equ = (sym)

  -D⋅K₂⋅s - D⋅K₂ + R⋅s + 2⋅R
  ──────────────────────────
   K₁⋅K₂⋅s + K₁⋅K₂ + s + 2
\frac{- D K_{2} s - D K_{2} + R s + 2 R}{K_{1} K_{2} s + K_{1} K_{2} + s + 2}
#+end_example

With $R(s) = D(s) = \frac{1}{s}$ we can find the sensitivity for $K_1$ and $K_2$.
\begin{align*}
e_{step}(\infty) &= \lim_{s\rightarrow 0} E(s) \\
e_{step}(\infty) &= \lim_{s\rightarrow 0} \frac{- K_{2} - s \left(K_{2} - 1\right) + 2}{s \left(K_{1} K_{2} s + K_{1} K_{2} + s + 2\right)} \\
e_{step}(\infty) &= \frac{1 - K_2}{2}
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q2
E_equ = subs(E_equ, R, 1/s);
E_equ = subs(E_equ, D, 1/s);
E_equ = simplify(E_equ);
latex(E_equ)
E_equ = limit(E_equ, s, 0);
latex(E_equ)
#+END_SRC

#+RESULTS:
: \frac{- K_{2} - s \left(K_{2} - 1\right) + 2}{s \left(K_{1} K_{2} s + K_{1} K_{2} + s + 2\right)}
: \infty \operatorname{sign}{\left(\frac{2 - K_{2}}{K_{1} K_{2} + 2} \right)}

\begin{align*}
P_{e_{step}:K_1} &= \frac{K_1}{e_{step}} \frac{\partial e_{step}}{\partial K_1} \\
P_{e_{step}:K_1} &= 0
\end{align*}
And
\begin{align*}
P_{e_{step}:K_2} &= \frac{K_2}{e_{step}} \frac{\partial e_{step}}{\partial K_2} \\
P_{e_{step}:K_1} &= \frac{K_{2}}{K_{2} - 1} \\
\textrm{With } K_2 &= 0.1 \\
P_{e_{step}:K_1} &= -0.1111
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q2
e = (1- K_2)/2
P_K_1 = (K_1/e)*diff(e, K_1)

P_K_2 = (K_2/e)*diff(e, K_2);
P_K_2 = simplify(P_K_2);
latex(P_K_2)
double(subs(P_K_2, K_2, 0.1))
#+END_SRC

#+RESULTS:
: e = (sym)
: 
:   1   K₂
:   ─ - ──
:   2   2
: P_K_1 = (sym) 0
: \frac{K_{2}}{K_{2} - 1}
: ans = -0.1111

* Question 3
** a
\begin{align*}
T(s) &= \frac{G(s)}{1 + G(s)H(s)} \\
T(s) &= \frac{\frac{1}{s^4 + 8s^3 + 18s^2 + 16s + 1}}{1 + K\frac{1}{s^4 + 8s^3 + 18s^2 + 16s + 1}} \\
T(s) &= \frac{1}{s^{4} + 8 s^{3} + 18 s^{2} + 16 s + 1 + K}
\end{align*}
#+BEGIN_SRC octave :exports none :results output :session Q3
clc
clear
close all

if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  warning('off');
  pkg load symbolic
  pkg load control
end

syms s K

G = 1/(s^4 + 8*s^3 + 18*s^2 + 16*s + 1);
H = K;

T = G/(1 + G*H);
T = simplify(T);
latex(T)
#+END_SRC

#+RESULTS:
: Symbolic pkg v3.2.2: Python communication link active, SymPy v1.14.0.
: \frac{1}{K + s^{4} + 8 s^{3} + 18 s^{2} + 16 s + 1}


** b
Zeros are at $\{(-0.0675, -5.0598 , -1.4364 - 0.9307i, -1.4364 + 0.9307i)\}$

#+BEGIN_SRC octave :exports none :results output :session Q3
s = tf('s');
g = 1/(s^4 + 8*s^3 + 18*s^2 + 16*s + 1);
rlocus(g)
[num, den] = numden(G);
syms s
poles = double(solve(den, s))
#+END_SRC

#+RESULTS:
: poles =
: 
:   -0.0675 +      0i
:   -1.4364 - 0.9307i
:   -1.4364 + 0.9307i
:   -5.0598 +      0i
*** 1 - Breakaway Points
\begin{align*}
G(s)H(s) &= \frac{1}{s^4 + 8s^3 + 18s^2 + 16s + 1} \cdot K \\
G(s)H(s) &= \frac{K}{s^4 + 8s^3 + 18s^2 + 16s + 1} \\
-1 &= \frac{K}{\sigma^4 + 8\sigma^3 + 18\sigma^2 + 16\sigma + 1} \\
K &= -\sigma^4 - 8\sigma^3 - 18\sigma^2 - 16\sigma - 1 \\
\frac{dK}{d\sigma} &= -4\sigma^3 - 24\sigma^2 - 36\sigma - 16 = 0 \\
\Rightarrow \sigma &= -4\ \textrm{or}\ -1
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q3
dK_ds = diff(-1*den, s);
solve(0 == dK_ds, s)
#+END_SRC

#+RESULTS:
: ans = (sym 2×1 matrix)
: 
:   ⎡-4⎤
:   ⎢  ⎥
:   ⎣-1⎦

\begin{align*}
\frac{d^2K}{d\sigma^2} &= -12\sigma^2 - 48\sigma - 36 = 0 \\
\frac{d^2K}{d\sigma^2}|_{-4} &= -420 \\
\frac{d^2K}{d\sigma^2}|_{-1} &= 0
\end{align*}

Which means at $s = -4 + 0j$ is a break-out point and at $s = -1 + 0j$ is a break-in break-out-point.
*** 2 - Asymptotes
\begin{align*}
\sigma_a &= \frac{\sum \textrm{finite poles} - \sum \textrm{finite zeros}}{\#\textrm{finite poles} - \#\textrm{finite zeors}} \\
\sigma_a &= \frac{(-0.0675 - -5.0598 - -1.4364 - 0.9307j - -1.4364 + 0.9307j) - (0)}{(4) - (0)} \\
\sigma_a &= -2
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q3
sum(poles)./length(poles)
#+END_SRC

#+RESULTS:
: ans = -2

\begin{align*}
\theta_a &= \frac{(2k + 1)180^o}{\#\textrm{finite poles} - \#\textrm{finite zeors}} \\
\theta_a &= \frac{(2k + 1)180^o}{(4) - (0)} \\
\Rightarrow \theta_a &= 45^o, 135^o, 225\ \textrm{and}\ 315^o
\end{align*}

*** 3 - $j\omega$ Crossings
Using Rougth-Hurwitz on $s^{4} + 8 s^{3} + 18 s^{2} + 16 s + 1 + K$.
#+ATTR_LATEX: :align |c|c|c|c|
|-------+------------+-----+-------|
| $s^4$ |          1 |  18 | 1 + K |
|-------+------------+-----+-------|
| $s^3$ |          8 |  16 |     0 |
|-------+------------+-----+-------|
| $s^2$ |         16 | K+1 |     0 |
|-------+------------+-----+-------|
| $s^1$ | K/2 - 31/2 |   0 |     0 |
|-------+------------+-----+-------|
| $s^0$ |       -x-1 |   0 |     0 |
|-------+------------+-----+-------|

For what value of $K$ does the first column encounter a zero?

#+BEGIN_SRC octave :exports none :results output :session Q3
pkg load symbolic
syms K w s

equ1 = K/2 - 31/2 == 0
equ2 = -K-1 == 0
solve(equ1, K)
solve(equ2, K)
#+END_SRC

#+RESULTS:
#+begin_example
equ1 = (sym)

  K   31    
  ─ - ── = 0
  2   2
equ2 = (sym) -K - 1 = 0
ans = (sym) 31
ans = (sym) -1
#+end_example

Solving the two equations in the first column gives $K = 31$ or $K = -1$, $K$ cannot be negative so just $K = 31$.

/I looked at the past exams and could not figure out how to get the next equation to find at which location it occurs, I'll study this before the exam/

*Root Locus On Next Page*

[[xopp-pages:/home/baley/UTAS/org-roam/org-files/ENG331_Assignment_5_Q3.xopp]]
