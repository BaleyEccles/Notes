:PROPERTIES:
:ID:       4845e439-6804-4e2e-821c-ca470e9623e7
:END:
#+title: ENG331 - Control Systems 1 - Assignment 5
#+date: [2025-10-06 Mon 09:12]
#+AUTHOR: Baley Eccles - 652137
#+STARTUP: latexpreview

* Question 1
\begin{align*}
T(s) &= \frac{G(s)}{1 + G(s)H(s)} \\
T(s) &= \frac{\frac{K}{s(s + 2)(s + 5)}}{1 + \frac{K}{s(s + 2)(s + 5)}(s + a)} \\
T(s) &= \frac{K}{K \left(a + s\right) + s \left(s + 2\right) \left(s + 5\right)} \\
\\
K_p &= \lim_{s\rightarrow0}T(s) \\
K_p &= \lim_{s\rightarrow0}\frac{K}{K \left(a + s\right) + s \left(s + 2\right) \left(s + 5\right)} \\
K_p &= \frac{1}{a} \\
e_{step}(\infty) &= \frac{1}{1 + K_p} \\
e_{step}(\infty) &= \frac{1}{1 + \frac{1}{a}} \\
e_{step}(\infty) &= \frac{a}{a + 1} \\
\\
P_{e_{step}:a} &= \frac{a}{e_{step}(\infty)}\frac{\partial e_{step}(\infty)}{\partial a} \\
P_{e_{step}:a} &= \frac{a}{\frac{a}{a + 1}} \frac{1}{\left(a + 1\right)^{2}} \\
P_{e_{step}:a} &=\frac{1}{a + 1}
\end{align*}
:TODO: Add plot
#+BEGIN_SRC octave :exports none :results output :session Q1
clc
clear
close all

if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  warning('off');
  pkg load symbolic
end

syms s K a

T = ((K)/(s*(s + 2)*(s + 5)))/(1 + (K)/(s*(s + 2)*(s + 5))*(s + a));
T = simplify(T);
latex(T)

K_p = subs(T, s, 0);
latex(K_p)

e_step = 1/(1 + K_p);
latex(simplify(e_step))

de_da = simplify(diff(e_step, a));
latex(de_da)
P = de_da*a/(a/(a + 1));
latex(P)

%t = -2.2:0.1:10;
%
%err = 1./(1 + 1./t);
%figure;
%plot(t, err);
%xlabel('a');
%xlabel('Steady state error');
%grid on;
%print -dpng 'ENG331_Assignment_5_Q1.png'
#+END_SRC

#+RESULTS:
: \frac{K}{K \left(a + s\right) + s \left(s + 2\right) \left(s + 5\right)}
: \frac{1}{a}
: \frac{a}{a + 1}
: \frac{1}{\left(a + 1\right)^{2}}
: \frac{1}{a + 1}

* Question 2
\begin{align*}
T(s) &= \frac{G(s)}{1 + G(s)H(s)} \\
T(s) &= \frac{(K_1 + D(s))\left(\frac{K_2}{s + 2}\right)}{1 + (K_1 + D(s))\left(\frac{K_2}{s + 2}\right)(s + 1)} \\
T(s) &= \frac{K_{2} \left(D(s) + K_{1}\right)}{K_{2} \left(D(s) + K_{1}\right) \left(s + 1\right) + s + 2} \\
T(s) &= \frac{D(s) + 100}{D(s) s + D(s) + 110 s + 120} \\
\\
K_p &= \lim_{s\rightarrow0}T(s) \\
K_p &= \lim_{s\rightarrow0}\frac{D(s) + 100}{D(s) s + D(s) + 110 s + 120} \\
K_p &= \lim_{s\rightarrow0}\frac{K_{2} \left(K_{1} s + 1\right)}{K_{2} \left(s + 1\right) \left(K_{1} s + 1\right) + s \left(s + 2\right)} \\
K_p &= \\
e_{step}(\infty) &= \frac{1}{1 + K_p} \\
e_{step}(\infty) &= \frac{1}{1 + \frac{D(s) + 100}{D(s) + 120}} \\
e_{step}(\infty) &= \frac{D(s) + 120}{2D(s) + 220} \\
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q2
clc
clear
close all

if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  warning('off');
  pkg load symbolic
end

syms K_1 K_2 s D

G = (K_1 + D)*(K_2/(s + 2));
H = s + 1;

T = G/(1 + G*H);
T = simplify(T);
latex(T)

T = subs(T, D, 1/s);
T = simplify(T);
latex(T)

K_p = simplify(subs(T, s, 0));
latex(K_p)

e_step = simplify(1/(1 + K_p));
latex(e_step)
#+END_SRC

#+RESULTS:
: \frac{K_{2} \left(D + K_{1}\right)}{K_{2} \left(D + K_{1}\right) \left(s + 1\right) + s + 2}
: \frac{K_{2} \left(K_{1} s + 1\right)}{K_{2} \left(s + 1\right) \left(K_{1} s + 1\right) + s \left(s + 2\right)}
: 1
: \frac{1}{2}

* Question 3
** a
\begin{align*}
T(s) &= \frac{G(s)}{1 + G(s)H(s)} \\
T(s) &= \frac{\frac{1}{s^4 + 8s^3 + 18s^2 + 16s + 1}}{1 + K\frac{1}{s^4 + 8s^3 + 18s^2 + 16s + 1}} \\
T(s) &= \frac{1}{s^{4} + 8 s^{3} + 18 s^{2} + 16 s + 1 + K}
\end{align*}
#+BEGIN_SRC octave :exports none :results output :session Q3
clc
clear
close all

if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  warning('off');
  pkg load symbolic
  pkg load control
end

syms s K

G = 1/(s^4 + 8*s^3 + 18*s^2 + 16*s + 1);
H = K;

T = G/(1 + G*H);
T = simplify(T);
latex(T)
#+END_SRC

#+RESULTS:
: \frac{1}{K + s^{4} + 8 s^{3} + 18 s^{2} + 16 s + 1}

[[xopp-pages:/home/baley/UTAS/org-roam/org-files/ENG331_Assignment_5_Q3.xopp]]
** b
Zeros are at $\{(-0.0675, -5.0598 , -1.4364 - 0.9307i, -1.4364 + 0.9307i)\}$

#+BEGIN_SRC octave :exports none :results output :session Q3
s = tf('s');
g = 1/(s^4 + 8*s^3 + 18*s^2 + 16*s + 1);
rlocus(g)
[num, den] = numden(G);
syms s
poles = double(solve(den, s))
#+END_SRC

#+RESULTS:
: poles =
: 
:   -0.0675 +      0i
:   -1.4364 - 0.9307i
:   -1.4364 + 0.9307i
:   -5.0598 +      0i
*** 1 - Breakaway Points
\begin{align*}
G(s)H(s) &= \frac{1}{s^4 + 8s^3 + 18s^2 + 16s + 1} \cdot K \\
G(s)H(s) &= \frac{K}{s^4 + 8s^3 + 18s^2 + 16s + 1} \\
-1 &= \frac{K}{\sigma^4 + 8\sigma^3 + 18\sigma^2 + 16\sigma + 1} \\
K &= -\sigma^4 - 8\sigma^3 - 18\sigma^2 - 16\sigma - 1 \\
\frac{dK}{d\sigma} &= -4\sigma^3 - 24\sigma^2 - 36\sigma - 16 = 0 \\
\Rightarrow \sigma &= -4\ \textrm{or}\ -1
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q3
dK_ds = diff(-1*den, s);
solve(0 == dK_ds, s)
#+END_SRC

#+RESULTS:
: ans = (sym 2×1 matrix)
: 
:   ⎡-4⎤
:   ⎢  ⎥
:   ⎣-1⎦
:TODO: check second derivative, should be zero for -1 should be 0

*** 2 - Asymptotes
\begin{align*}
\sigma_a &= \frac{\sum \textrm{finite poles} - \sum \textrm{finite zeros}}{\#\textrm{finite poles} - \#\textrm{finite zeors}} \\
\sigma_a &= \frac{(-0.0675 - -5.0598 - -1.4364 - 0.9307j - -1.4364 + 0.9307j) - (0)}{(4) - (0)} \\
\sigma_a &= -2
\end{align*}

#+BEGIN_SRC octave :exports none :results output :session Q3
sum(poles)./length(poles)
#+END_SRC

#+RESULTS:
: ans = -2

\begin{align*}
\theta_a &= \frac{(2k + 1)180^o}{\#\textrm{finite poles} - \#\textrm{finite zeors}} \\
\theta_a &= \frac{(2k + 1)180^o}{(4) - (0)} \\
\Rightarrow \theta_a &= 45^o
\end{align*}

*** 3 - $j\omega$ Crossings
Using Rougth-Hurwitz on $s^{4} + 8 s^{3} + 18 s^{2} + 16 s + 1 + K$.
:TODO: Unsure if this is right
|-------+------------+-------+-------|
| $s^4$ |          1 |    18 | 1 + K |
|-------+------------+-------+-------|
| $s^3$ |          8 |    16 |     0 |
|-------+------------+-------+-------|
| $s^2$ |         16 | K + 1 |     0 |
|-------+------------+-------+-------|
| $s^1$ | 31/2 - K/2 |     0 |     0 |
|-------+------------+-------+-------|
| $s^0$ |      K + 1 |     0 |     0 |
|-------+------------+-------+-------|

For what value of $K$ does the first column encounter a zero?


#+BEGIN_SRC octave :exports none :results output :session Q3
pkg load symbolic
syms K

A = -(1*16 - 18*8)/8

B = -(1*0 - (K + 1)*8)/8

C = -(8*(K + 1) - 16*16)/16

D = -(8*0 - 16*0)/16

E = simplify(-(16*0 - (K+1)*(31/2 - K/2))/((31/2 - K/2)))

F = -(A*0 - C*0)/C

solve(C == 0, K)
solve(E == 0, K)
#+END_SRC

#+RESULTS:
#+begin_example
A = 16
B = (sym) K + 1
C = (sym)

  31   K
  ── - ─
  2    2
D = 0
E = (sym) K + 1
K + 1
F = (sym) 0
ans = (sym) 31
ans = (sym) -1
#+end_example


