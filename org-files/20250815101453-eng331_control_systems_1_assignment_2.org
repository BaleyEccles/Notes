:PROPERTIES:
:ID:       96e084e6-aded-49b7-9522-3bdd9dd97344
:END:
#+title: ENG331 - Control Systems 1 - Assignment 2
#+date: [2025-08-15 Fri 10:14]
#+AUTHOR: Baley Eccles - 652137
#+STARTUP: latexpreview

* Question 1
** a
\begin{align*}
f(t) &= \frac{d^2i_L(t)}{dt^2} + \frac{1}{RC}\frac{di_L(t)}{dt} + \frac{1}{LC}i_L(t) \\
\mathcal{L}\{\hdots\} &: F(s) = s^2I_L(s) + \frac{1}{RC}sI_L(t) + \frac{1}{LC}I_L(s) \\
F(s) &= I_L(s)\left(s^2 + \frac{1}{RC}s + \frac{1}{LC}\right) \\
\frac{I_L(s)}{F(s)} &= \frac{1}{s^2 + \frac{1}{RC}s + \frac{1}{LC}}
\end{align*}
** b
From the second order prototype form:
\[G(s) = \frac{K\omega_n^2}{s^2 + 2\zeta \omega_ns + \omega_n^2}\]
We can get the system of equations:
\[\begin{cases}
K\omega_n^2 &= 1 \\
2\zeta \omega_n &= \frac{1}{RC} \\
\omega_n^2 &= \frac{1}{LC}
\end{cases}\]
Which means:
\begin{align*}
K &= LC \\
\omega_n &= \frac{1}{\sqrt{LC}} \\
\zeta &= \frac{\sqrt{L}}{2R\sqrt{C}} \\
\end{align*}
** c
Using the following equations:
\begin{align*}
\%OS &= e^{-\zeta\pi/\sqrt{1 - \zeta^2}}\\
T_s &\approx \frac{4}{\zeta \omega_n} \\
\end{align*}
A system of equations can be formed:
\begin{cases}
0.1 &= e^{-\frac{\sqrt{L}}{2R\sqrt{0.1}}\pi/\sqrt{1 - \left(\frac{\sqrt{L}}{2R\sqrt{0.1}}\right)^2}}\\
5 &\approx \frac{4}{\frac{\sqrt{L}}{2R\sqrt{0.1}} \frac{1}{\sqrt{0.1L}}} \\
\end{cases}
Solving using a calculator:
\begin{align*}
R &= 6.25\Omega \\
L &= 5.46H
\end{align*}

* TODO Question 2
** a
First we must get the transfer function:
\begin{align*}
10r(t) &= 8\frac{d^2c(t)}{dt^2} + 2\frac{dc(t)}{dt} + 40c(t) \\
\mathcal{L}\{\hdots\} &: 10R(s) = 8s^2C(s) + 2sC(t) + 40C(s) \\
40R(s) &= C(s)\left(8s^2 + 2s + 40\right) \\
\frac{C(s)}{R(s)} &= G(s) = \frac{40}{8s^2 + 2s + 40}
\end{align*}

Next we can apply a step response ($U(s) = \frac{1}{s}$) to the system
\[\frac{1}{s}G(s) &= \frac{1}{s}\frac{40}{8s^2 + 2s + 40}\]


#+BEGIN_SRC octave :exports none :results output :session Des1
clc
clear
close all
pkg load symbolic

syms s
G = (1/s)*(40/(8*s^2 + 2*s + 40))
latex(ilaplace(G))
partfrac(G)
latex(partfrac(G))
#+END_SRC

#+RESULTS:
#+begin_example
Symbolic pkg v3.2.1: Python communication link active, SymPy v1.14.0.
H = (sym)

          40         
  ───────────────────
    ⎛   2           ⎞
  s⋅⎝8⋅s  + 2⋅s + 40⎠
1 - \frac{\sqrt{319} e^{- \frac{t}{8}} \sin{\left(\frac{\sqrt{319} t}{8} \right)}}{319} - e^{- \frac{t}{8}} \cos{\left(\frac{\sqrt{319} t}{8} \right)}
ans = (sym)

       4⋅s + 1      1
  - ───────────── + ─
       2            s
    4⋅s  + s + 20
- \frac{4 s + 1}{4 s^{2} + s + 20} + \frac{1}{s}
#+end_example

Now we must do the inverse Laplace transform, to do this we must do partial fractions expansion
\[-\frac{4 s + 1}{4 s^{2} + s + 20} + \frac{1}{s}\]
:TODO: Show working rather than using matlab
\[u(t) - \frac{\sqrt{319} e^{- \frac{t}{8}} \sin{\left(\frac{\sqrt{319} t}{8} \right)}}{319}u(t) - e^{- \frac{t}{8}} \cos{\left(\frac{\sqrt{319} t}{8} \right)}u(t)\]
** b
The forced response is:
\[u(t)\]
** c
The natural/transient response is:
\[- \frac{\sqrt{319} e^{- \frac{t}{8}} \sin{\left(\frac{\sqrt{319} t}{8} \right)}}{319}u(t) - e^{- \frac{t}{8}} \cos{\left(\frac{\sqrt{319} t}{8} \right)}u(t)\]
** d
\[G(s) &= \frac{40}{8s^2 + 2s + 40}\]

Poles are at $-0.1250 - 2.2326i$ and $-0.1250 + 2.2326i$


#+BEGIN_SRC octave :exports none :results output :session Q2_d
clc
clear
close all
if exist('OCTAVE_VERSION', 'builtin')
  set(0, "DefaultLineLineWidth", 2);
  set(0, "DefaultAxesFontSize", 25);
  pkg load symbolic
end

syms s
poles = eval(solve(8*s^2 + 2*s + 40 == 0, s))

hold on;
plot(real(poles(1)), imag(poles(1)), 'bx');
plot(real(poles(2)), imag(poles(2)), 'bx');
axis([-3 3 -3 3]);
axis equal;
grid on;
set (gca, "xaxislocation", "origin");
set (gca, "yaxislocation", "origin");
xlabel('Re(s)');
ylabel('Im(s)');
#+END_SRC

#+RESULTS:
#+begin_example
Symbolic pkg v3.2.1: Python communication link active, SymPy v1.14.0.
poles =

  -0.1250 - 2.2326i
  -0.1250 + 2.2326i
warning: passing floating-point values to sym is dangerous, see "help sym"
warning: called from
    double_to_sym_heuristic at line 50 column 7
    sym at line 384 column 11
    mtimes at line 54 column 3

poles =

  -0.1250 - 2.2326i
  -0.1250 + 2.2326i
#+end_example

To find the other stuff we must convert the system into the second order prototype form:
\begin{align*}
G(s) &= \frac{K\omega_n^2}{s^2 + 2\zeta \omega_ns + \omega_n^2} \\
G(s) &= \frac{\frac{40}{8}}{s^2 + \frac{2}{8}s + \frac{40}{8}} \\
G(s) &= \frac{5}{s^2 + 0.25s + 5}
\end{align*}

This allows us to create the system of equations:
\begin{cases}
K\omega_n^2 &= 5 \\
2\zeta\omega_n &= 0.25 \\
\omega_n^2 &= 5
\end{cases}
#+BEGIN_SRC octave :exports none :results output :session Q2_d_2
clc
clear
close all

omega_n = sqrt(5)
zeta = 0.25/2/omega_n

omega_d = omega_n*sqrt(1 - zeta^2)
sigma_d = 0.1250
theta = acos(zeta)

#+END_SRC

#+RESULTS:
: omega_n = 2.2361
: zeta = 0.055902
: omega_d = 2.2326
: sigma_d = 0.1250
: theta = 1.5149

Which means, $\omega_n = \sqrt{5} \approx 2.236\ rad/s$, $\zeta = 0.0559$ and $K = 1$. Next we can calculate $\omega_d$, $\sigma_d$ and $\theta$.
\[\omega_d = \omega_n\sqrt{1 - \zeta^2} = 2.23\]
\[\sigma_d = - \Re\{\textrm{root}\} = 0.1250\] :TODO: This might be wrong
\[\theta = \cos^{-1}(\zeta) = \cos^{-1}(0.025) = 1.546\]
** e
$\zeta < 1$, therefore the system is underdamped

** f
We can use the final value theorem:
\begin{align*}
c(t \rightarrow \infty) &= \lim_{s\rightarrow 0} sC(s) \\
c(t \rightarrow \infty) &= \lim_{s\rightarrow 0} \frac{1}{s}\frac{5s}{s^2 + 0.25s + 5} \\
c(t \rightarrow \infty) &= 1
\end{align*}

** g
The DC gain is
\begin{align*}
\lim_{s\rightarrow 0} G(s) &= \frac{5}{s^2 + 0.25s + 5} \\
\lim_{s\rightarrow 0} G(s) &= 1
\end{align*}

** f
#+BEGIN_SRC octave :exports none :results output :session Q2_d_2
OS = exp(-zeta*pi/sqrt(1 - zeta^2))*100
T_p = pi/omega_d
T_s = 4/(zeta*omega_n)
#+END_SRC

#+RESULTS:
: OS = 83.871
: T_p = 1.4072
: T_s = 32

\begin{align*}
\%OS &= e^{-\zeta\pi/\sqrt{1 - \zeta^2}} \\
\%OS &= e^{-0.0559\pi/\sqrt{1 - 0.0559^2}} \\
\%OS &= 83.871%
\end{align*}

\begin{align*}
T_p &= \frac{\pi}{\omega_d} \\
T_p &= \frac{\pi}{2.23} \\
T_p &= 1.408\ s
\end{align*}

\begin{align*}
T_s &\approx \frac{4}{\zeta \omega_n} \\
T_s &\approx \frac{4}{0.0559\cdot 2.236} \\
T_s &\approx 32\ s
\end{align*}

We need to use a table for the rise time:
[[./Rise_Time_Table.png]]

\begin{align*}
T_{r,\textrm{normalised}} = 
\end{align*}
* Question 3
