:PROPERTIES:
:ID:       3eb76f9d-5112-49a0-8b21-8976591d6fd6
:END:
#+title: ENG331 - Control Systems 1 - Assignment 4
#+date: [2025-09-19 Fri 09:20]
#+AUTHOR: Baley Eccles - 652137
#+FILETAGS: :Assignment:UTAS:2025:
#+LATEX_HEADER: \usepackage[a4paper, margin=2cm]{geometry}
#+LATEX_HEADER_EXTRA: \usepackage{minted}
#+LATEX_HEADER_EXTRA: \usepackage{fontspec}
#+LATEX_HEADER_EXTRA: \setmonofont{Iosevka}
#+LATEX_HEADER_EXTRA: \setminted{fontsize=\small, frame=single, breaklines=true}
#+LATEX_HEADER_EXTRA: \usemintedstyle{emacs}
#+LATEX_HEADER_EXTRA: \usepackage{float}
#+LATEX_HEADER_EXTRA: \usepackage[final]{pdfpages}
#+LATEX_HEADER_EXTRA: \setlength{\parindent}{0pt}
#+LATEX_HEADER_EXTRA: \setlength{\parskip}{1em}

* Question 1
** a
Using $T(s) = \frac{G(s)}{1 + G(s)H(s)}$
\begin{align*}
G(s) &= \frac{K100(s+1)(s^2 - 4s + 104)}{(s+3)(100s^2 + 2475s - 3467)} \textrm{ and } H(s) = 1 \\
T(s) &= \frac{\frac{K100(s+1)(s^2 - 4s + 104}{(s+3)(100s^2 + 2475s - 3467)}}{1 + \frac{K100(s+1)(s^2 - 4s + 104}{(s+3)(100s^2 + 2475s - 3467)}1} \\
T(s) &= \frac{100 K s^{3} - 300 K s^{2} + 10000 K s + 10400 K}{100 K s^{3}  + 100 s^{3} - 300 K s^{2} + 2775 s^{2} + 10000 K s + 3958 s - 10401  + 10400 K}
\end{align*}
#+BEGIN_SRC octave :exports code :results output :session Q1
clc
clear
close all

pkg load symbolic

syms s K;
H = 1;
G = (K*100*(s+1)*(s^2 - 4*s + 104))/((s+3)*(100*s^2 + 2475*s - 3467));

T = G/(1 + G*H);
% Simplify T
T_simplified = simplify(T);

% Get the numerator and denominator of T
[num, den] = numden(T_simplified);
latex(expand(num))
latex(expand(den))

#+END_SRC

#+RESULTS:
: Symbolic pkg v3.2.2: Python communication link active, SymPy v1.14.0.
: 100 K s^{3} - 300 K s^{2} + 10000 K s + 10400 K
: 100 K s^{3} - 300 K s^{2} + 10000 K s + 10400 K + 100 s^{3} + 2775 s^{2} + 3958 s - 10401

** b
\[100(K + 1) s^{3} +  (2775 - 300 K)s^{2} + (10000 K + 3958) s + (10400 K - 10401)\]
Using Routh–Hurwitz table:
#+ATTR_LATEX: :align |c|c|c|
|-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| $s^3$ | $100(K+1)$                                                                                                                                                                                  | $10000K + 3958$                                                                          |
|-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| $s^2$ | $2775 - 300K$                                                                                                                                                                               | $10400K - 10401$                                                                         |
|-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| $s^1$ | $\frac{-\begin{bmatrix}100(K + 1) & 10000 + 3958K \\ 2775 - 300K & 10400K - 10401\end{bmatrix}}{2775 - 300K} = \frac{2(-80800^2 + 531254K + 240471)}{3(4K-37)}$                             | $\frac{-\begin{bmatrix}100(K + 1) & 0 \\ 2775 - 300K & 0\end{bmatrix}}{2775 - 300K} = 0$ |
|-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| $s^0$ | $\frac{-\begin{bmatrix}2775 - 300K & 10400K - 10401 \\ \frac{2(-80800^2 + 531254K + 240471)}{3(4K-37)} & 0\end{bmatrix}}{\frac{2(-80800^2 + 531254K + 240471)}{3(4K-37)}} = 10400K - 10401$ | $0$                                                                                      |
|-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|

The system is unstable when the first column encounters a sign change, so we need to find when the following are greater than 0, which can be done with matlab:
#+BEGIN_SRC octave :exports code :results output :session Q1
syms K real positive;

eq1 = 100*(K+1) > 0;
sol1 = solve(eq1, K);

eq2 = 2775 - 300*K > 0;
sol2 = solve(eq2, K);

eq3 = (2*(-80800*K^2 + 531254*K + 240471))/(3*(4*K-37)) > 0;
sol3 = solve(eq3, K);

eq4 = 10400*K - 10401 > 0;
sol4 = solve(eq4, K);

sol5 = solve(eq1, eq2, eq3, eq4, K);

#latex(sol5)

sol1
sol2
latex(sol3)
sol4
#+END_SRC

#+RESULTS:
: sol1 = {}(0x0)
: sol2 = (sym) K < 37/4
: K < \frac{37}{4} \wedge \frac{265627}{80800} + \frac{\sqrt{89987759929}}{80800} < K
: sol4 = (sym)
: 
:   10401    
:   ───── < K
:   10400

Which gives the following inequalities
\begin{align*}
K &< 37/4 = 9.25\\
K &< \frac{37}{4} \wedge \frac{265627}{80800} + \frac{\sqrt{89987759929}}{80800} \approx 7
K &> \frac{10401}{10400} \approx 1
\end{align*}

Which means $1 < K < 7$.

** c
Taking $K = \frac{7-1}{2} = 3$
\begin{align*}
K_p &= \lim_{s\rightarrow 0}G(s) = \frac{300 \left(s + 1\right) \left(s^{2} - 4 s + 104\right)}{\left(s + 3\right) \left(100 s^{2} + 2475 s - 3467\right)} = -3 \\
e_{step}(\infty) &= \frac{1}{1 + K_p} \\
e_{step}(\infty) &= \frac{1}{1 - 3} = -0.5\\
\end{align*}


#+BEGIN_SRC octave :exports code :results output :session Q1
syms s K
G = subs(G, K, 3);
latex(G)
K_p = double(subs(G, s, 0))

1/(1 + K_p)
#+END_SRC

#+RESULTS:
: \frac{300 \left(s + 1\right) \left(s^{2} - 4 s + 104\right)}{\left(s + 3\right) \left(100 s^{2} + 2475 s - 3467\right)}
: K_p = -2.9997
: ans = -0.5001

* Question 2
first we must convert the state space representation to laplace, then use Routh-Hurwitz. This can be done using $G(s) = C(sI - A)^{-1}B + D$.
\begin{align*}
G(s) &= C(sI - A)^{-1}B + D \\
G(s) &= \begin{bmatrix}
1 & 0 & 1
\end{bmatrix}
\left(
s
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 
\end{bmatrix}
-
\begin{bmatrix}
0  & 1  & 0 \\
0  & 1  & 2 \\
-5 & -4 & -3 \\
\end{bmatrix}
\right)^{-1}
\begin{bmatrix}
0 \\
1 \\
0
\end{bmatrix}
+
\begin{bmatrix}
0
\end{bmatrix}
\end{align*}
Using MATLAB to find solve this:
#+BEGIN_SRC octave :exports code :results output :session Q2
clc
clear
close all;
pkg load symbolic
syms s

A = [0, 1, 0; 0, 1, 2; -5, -4, -3];
B = [0; 1; 0];
C = [1, 0, 1];
G = factor(C*inv(s*eye(3,3) - A)*B)

#+END_SRC

#+RESULTS:
: G = (sym)
: 
:     -(3⋅s + 2)    
:   ────────────────
:           ⎛ 2    ⎞
:   (s + 2)⋅⎝s  + 5⎠

Getting the closed-loop transfer function using $T = \frac{G(s)}{1 - G(s)H(s)}$
\[T(s) = \frac{- 3 s - 2}{s^{3} + 2 s^{2} + 2 s + 8}\]
#+BEGIN_SRC octave :exports code :results output :session Q2
H = 1;
T = simplify(G/(1 + G*H));

[num, den] = numden(T);
latex(expand(num))
latex(expand(den))
#+END_SRC

#+RESULTS:
: - 3 s - 2
: s^{3} + 2 s^{2} + 2 s + 8


Which gives $G(s) = \frac{- 3 s - 2}{s^{3} + 2 s^{2} + 5 s + 10}$. Using the denominator and Routh-Hurwitz:
|-----+---------------------------------------------------------------+-------------------------------------------------------------|
| s^3 |                                                             1 |                                                           2 |
|-----+---------------------------------------------------------------+-------------------------------------------------------------|
| s^2 |                                                             2 |                                                           8 |
|-----+---------------------------------------------------------------+-------------------------------------------------------------|
| s^1 |  $\frac{-\begin{bmatrix}1 & 2 \\ 2 & 8\end{bmatrix}}{2} = -2$ | $\frac{-\begin{bmatrix}1 & 9 \\ 2 & 0\end{bmatrix}}{2} = 0$ |
|-----+---------------------------------------------------------------+-------------------------------------------------------------|
| s^0 | $\frac{-\begin{bmatrix}2 & 8 \\ -2 & 0\end{bmatrix}}{-2} = 8$ |                                                           0 |
|-----+---------------------------------------------------------------+-------------------------------------------------------------|
There are sign changes in the first column of the table, so the system is unstable.

* Question 3
** a
Using $\frac{G(s)}{1 + G(s)H(s)}$ and then multiplication:
\begin{align*}
\frac{\theta_0(s)}{\theta_c(s) - \theta_0(s)} &= \frac{s + 0.01}{s}\cdot\frac{1}{s}\cdot\frac{\frac{K_c}{s}\frac{1}{s}\frac{s + 0.01}{s}}{1 + \frac{K_c}{s}\frac{1}{s}\frac{s + 0.01}{s}} \\
\frac{\theta_0(s)}{\theta_c(s) - \theta_0(s)} &= \frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}}
\end{align*}


#+BEGIN_SRC octave :exports code :results output :session Q3
close all
pkg load symbolic
syms s K_c J

G = ((s + 0.01)/s)*(1/s)*((K_c/J)*(1/s)*((s + 0.01)/s)) / (1 + (K_c/J)*(1/s)*((s + 0.01)/s));
latex(simplify(G))
G = simplify(G)

[num, den] = numden(G);

latex(expand(num))
latex(expand(den))


#+END_SRC

#+RESULTS:
#+begin_example
warning: passing floating-point values to sym is dangerous, see "help sym"
warning: called from
    double_to_sym_heuristic at line 50 column 7
    sym at line 384 column 13
    plus at line 53 column 5

warning: passing floating-point values to sym is dangerous, see "help sym"
warning: called from
    double_to_sym_heuristic at line 50 column 7
    sym at line 384 column 13
    plus at line 53 column 5

warning: passing floating-point values to sym is dangerous, see "help sym"
warning: called from
    double_to_sym_heuristic at line 50 column 7
    sym at line 384 column 13
    plus at line 53 column 5
\frac{K_{c} \left(100 s + 1\right)^{2}}{100 s^{2} \left(100 J s^{2} + K_{c} \left(100 s + 1\right)\right)}
G = (sym)

                          2          
           K_c⋅(100⋅s + 1)           
  ───────────────────────────────────
       2 ⎛       2                  ⎞
  100⋅s ⋅⎝100⋅J⋅s  + K_c⋅(100⋅s + 1)⎠
10000 K_{c} s^{2} + 200 K_{c} s + K_{c}
10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}
das = (sym)

           3          2          4
  10000⋅D⋅s  + 100⋅D⋅s  + 10000⋅s
a = (sym 3×1 matrix)

  ⎡          0           ⎤
  ⎢                      ⎥
  ⎢        ______________⎥
  ⎢  D   ╲╱ D⋅(25⋅D - 1) ⎥
  ⎢- ─ - ────────────────⎥
  ⎢  2          10       ⎥
  ⎢                      ⎥
  ⎢        ______________⎥
  ⎢  D   ╲╱ D⋅(25⋅D - 1) ⎥
  ⎢- ─ + ────────────────⎥
  ⎣  2          10       ⎦
ans = (sym) 0
#+end_example

** b
\begin{align*}
K_p &= \lim_{s\rightarrow 0}G(s) = \frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}} = \infty\\
e_{step}(\infty) &= \frac{1}{1 + K_p} \\
e_{step}(\infty) &= \frac{1}{1 - \infty} = 0\\
\end{align*}

#+BEGIN_SRC octave :exports code :results output :session Q3
syms s K
latex(G)
K_p = double(subs(G, s, 0))

1/(1 + K_p)
#+END_SRC

#+RESULTS:
: \frac{K_{c} \left(100 s + 1\right)^{2}}{100 s^{2} \left(100 J s^{2} + K_{c} \left(100 s + 1\right)\right)}
: K_p =  Inf + Infi
: ans = 0

** c
\begin{align*}
K_v &= \lim_{s\rightarrow 0}sG(s) = s\frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}} = \infty \\
e_{ramp}(\infty) &= \frac{1}{K_v} \\
e_{ramp}(\infty) &= \frac{1}{\infty} = 0\\
\end{align*}

#+BEGIN_SRC octave :exports code :results output :session Q3
syms s K
latex(G)
K_v = double(subs(s*G, s, 0))

1/(K_v)
#+END_SRC

#+RESULTS:
: \frac{K_{c} \left(100 s + 1\right)^{2}}{100 s^{2} \left(100 J s^{2} + K_{c} \left(100 s + 1\right)\right)}
: K_v =  Inf + Infi
: ans = 0
** d
\begin{align*}
K_a &= \lim_{s\rightarrow 0}s^2G(s) = s^2\frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}} = 0.01\\
e_{parabola}(\infty) &= \frac{1}{K_a} \\
e_{parabola}(\infty) &= \frac{1}{0.01} = 100
\end{align*}

#+BEGIN_SRC octave :exports code :results output :session Q3
syms s K
latex(G)
K_a = double(subs(s*s*G, s, 0))

1/(K_a)
#+END_SRC

#+RESULTS:
: \frac{K_{c} \left(100 s + 1\right)^{2}}{100 s^{2} \left(100 J s^{2} + K_{c} \left(100 s + 1\right)\right)}
: K_a = 0.010000
: ans = 100

** e
Using $\frac{G(s)}{1 + G(s)}$:
\begin{align*}
\frac{\theta_0(s)}{\theta_c(s)} &= \frac{\frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}}}{1 + \frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{10000 J s^{4} + 10000 K_{c} s^{3} + 100 K_{c} s^{2}}} \\
&= \frac{10000 K_{c} s^{2} + 200 K_{c} s + K_{c}}{100 J s^{2} + 10000 K_{c} s^{3} + 10100 K_{c} s^{2} + 200 K_{c} s + K_{c}} \\
&= \frac{10000 \frac{K_{c}}{J} s^{2} + 200 \frac{K_{c}}{J} s + \frac{K_{c}}{J}}{10000 \frac{K_{c}}{J} s^{3} + 100 s^{2} + 10100 \frac{K_{c}}{J}  s^{2} + 200 \frac{K_{c}}{J} s + \frac{K_{c}}{J}}
\end{align*}

#+BEGIN_SRC octave :exports code :results output :session Q3
T = G/(1 + G);
T_s = simplify(T);
latex(T_s)
[num, den] = numden(T_s);
latex(expand(num))
latex(expand(den))
#+END_SRC

#+RESULTS:
: \frac{K_{c} \left(100 s + 1\right)^{2}}{K_{c} \left(100 s + 1\right)^{2} + 100 s^{2} \left(100 J s^{2} + K_{c} \left(100 s + 1\right)\right)}
: 10000 K_{c} s^{2} + 200 K_{c} s + K_{c}
: 10000 J s^{4} + 10000 K_{c} s^{3} + 10100 K_{c} s^{2} + 200 K_{c} s + K_{c}

** f
Letting $\frac{K_c}{J} = A$
\[10000 A s^{3} + \left(100 + 10100 A\right) s^{2} + 200 A s + A\]
|-----+---------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| s^3 | $10 000A$                                                                                                                             | $200A$                                                                                   |
|-----+---------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| s^2 | $100 + 10 100A$                                                                                                                       | $A$                                                                                      |
|-----+---------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| s^1 | $\frac{-\begin{bmatrix}10 000A & 200A \\ 10 + 10 100A & A\end{bmatrix}}{100 + 10 100A} = \frac{10A(2019A + 20)}{101A + 1}$            | $\frac{-\begin{bmatrix}10 000A & 0 \\ 10 + 10 100A & 0\end{bmatrix}}{100 + 10 100A} = 0$ |
|-----+---------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|
| s^0 | $\frac{-\begin{bmatrix}100 + 10 100A & A \\ \frac{10A(2019A + 20)}{101A + 1} & 0\end{bmatrix}}{\frac{10A(2019A + 20)}{101A + 1}} = A$ | $0$                                                                                      |
|-----+---------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------|

For the system to be stable there must be no sign changes in the left column, this can be solved using the following MATLAB code:
#+BEGIN_SRC octave :exports code :results output :session Q3
syms A real;

eq1 = 10000*A > 0;
sol1 = solve(eq1, A);

eq2 = 100 + 10100*A > 0;
sol2 = solve(eq2, A);

eq3 = (10*A*(2019*A + 20))/(101*A + 1) > 0;
sol3 = solve(eq3, A);

eq4 = A > 0;
sol4 = solve(eq4, A);

latex(solve(eq1, eq2, eq3, eq4, A))

sol1
sol2
sol3
sol4
#+END_SRC

#+RESULTS:
: \left(\left(- \frac{20}{2019} < A \wedge A < - \frac{1}{101}\right) \vee 0 < A\right) \wedge 0 < A
: sol1 = (sym) 0 < A
: sol2 = (sym) -1/101 < A
: sol3 = (sym)
: 
:   ⎛-20                  ⎞        
:   ⎜──── < A ∧ A < -1/101⎟ ∨ 0 < A
:   ⎝2019                 ⎠
: sol4 = (sym) 0 < A

Which means:
\begin{align*}
\frac{-20}{2019} < &\frac{K_c}{J} < \frac{-1}{101} \\
-0.009906 < &\frac{K_c}{J} < -0.009901
\end{align*}
