:PROPERTIES:
:ID:       536ba461-384b-4879-9b5e-8155ff6cae59
:END:
#+title: ENG331 - Control Systems 1 - Lab 2
#+date: [2025-08-12 Tue 10:53]
#+AUTHOR: Baley Eccles - 652137
#+STARTUP: latexpreview
#+FILETAGS: :Assignment:UTAS:2025:
#+STARTUP: latexpreview
#+LATEX_HEADER: \usepackage[a4paper, margin=2cm]{geometry}
#+LATEX_HEADER_EXTRA: \usepackage{minted}
#+LATEX_HEADER_EXTRA: \usepackage{fontspec}
#+LATEX_HEADER_EXTRA: \setmonofont{Iosevka}
#+LATEX_HEADER_EXTRA: \setminted{fontsize=\small, frame=single, breaklines=true}
#+LATEX_HEADER_EXTRA: \usemintedstyle{emacs}
#+LATEX_HEADER_EXTRA: \usepackage{float}
#+LATEX_HEADER_EXTRA: \setlength{\parindent}{0pt}

* Task 2 - Plant Construction

** Part 1 - System Familiarisation and Calibration
*** Calibration
:DONE: /Measured Tank Heights:/
| Actual Tank 1 Height $h_{1,i}$ | Uncalibrated value $v_{1,i}$ | Actual tank 2 height $h_{2,i}$ | Uncalibrated value $v_{2,i}$ |
|                              4 |                           80 |                            8.5 |                          130 |
|                           11.5 |                          220 |                             22 |                          540 |


:DONE: /Calculated Scale and Offset/
Solving the following system of equations for Tank 1:
\[\begin{cases}
4  &= 80\cdot\textrm{scale} + \textrm{offset} \\
11.5  &= 220\cdot\textrm{scale} + \textrm{offset}
\end{cases}\]
We get $\textrm{scale} = 0.05357$ and $\textrm{offset} = -0.2857$

Solving the following system of equations for Tank 2:
\[\begin{cases}
8.5  &= 130\cdot\textrm{scale} + \textrm{offset} \\
22  &= 540\cdot\textrm{scale} + \textrm{offset}
\end{cases}\]
We get $\textrm{scale} = 0.03293$ and $\textrm{offset} = 4.22$

*** Tank Parameters
:DONE: /Record tank diameter, nozzle size for each tank:/
The bottom nozzle diameter (Tank 2) was recorded to be 4mm. Whereas the top nozzle diameter (Tank 1) was recorded to be 5mm.

The diameter of Tank 2 was recorded to be 4.5cm, likewise the diameter of Tank 1 was also recorded to be 4.5cm.

** Part 2 - System Identification

*** Pump Gain
:DONE: /Record the approximate pump gain:/
If we set the pump voltage to $V_p = 10V$ it takes $t = 11s$ to fill the tank to $h = 20cm$. This data allows us to calculate the pump gain.
\begin{align*}
\textrm{Vol} &= \pi r^2 h \\
\textrm{Vol} &= \pi (4.5/2)^2 \cdot 20 \\
\textrm{Vol} &= 0.000318 m^3 \\
\end{align*}
\begin{align*}
q_0 &= \frac{\textrm{Vol}}{t} \\
q_0 &= \frac{0.000318}{11} \\
q_0 &= 0.000029 m^3/s \\
\end{align*}
\begin{align*}
\textrm{Pump Gain} &= \frac{q_0}{V_p} \\
\textrm{Pump Gain} &= \frac{0.000029}{10} \\
\textrm{Pump Gain} &= 0.000003 \\
\end{align*}

If we set the pump voltage to $V_p = 5V$ it takes $t = 17.41s$ to fill the tank to $h = 20cm$. Once again, this data allows us to calculate the pump gain.
\begin{align*}
\textrm{Vol} &= \pi r^2 h \\
\textrm{Vol} &= \pi (4.5/2)^2\cdot 20 \\
\textrm{Vol} &= 0.000318 m^3 \\
\end{align*}
\begin{align*}
q_0 &= \frac{\textrm{Vol}}{t} \\
q_0 &= \frac{0.000318}{17.41s} \\
q_0 &= 0.000018 m^3/s \\
\end{align*}
\begin{align*}
\textrm{Pump Gain} &= \frac{q_0}{V_p} \\
\textrm{Pump Gain} &= \frac{0.000018}{5} \\
\textrm{Pump Gain} &= 0.000004 \\
\end{align*}

:TODO: /How well does our assumption of a linear relationship between output flow and pump voltage hold in this case?/

:TODO: /Will this have a significant effect on the accuracy of our theoretical model? Why/why not?/

*** Discharge Coefficient
:TODO: /Record the estimated $C_d$ for each tank:/
:NOTE: During the lab the we had Zeke attempt this too and he also could not calculate it. We were getting a value that was ?greater than one?, which is impossible and does not make sense.

Tank 1:
From 10->25
t = 10s
$Vol = \pi (4.5/2)^2 (25 - 10)$
$Vol = 0.000239m^3$
$q_1 = \frac{Vol}{t}$
$q_1 = 0.000024$

$C_{d,1} = \frac{q_1}{q_{1,ideal}}$

Tank 2:
from 4->26.5
$h_1 = 11cm$
t = 15.44s

Something went wrong :(



**** IGNORE
From 4->25
t = 14.5s
$Vol = \pi (4.5/2)^2 (25 - 4)$
$Vol = 0.000334m^3$
$q_2 = \frac{Vol}{t}$
$q_2 = 0.000023$

$C_{d,2} = \frac{q_2}{q_{2,ideal}}$

\[q_{out} = \frac{\pi}{4} D^2 C_d\sqrt{2gh_1}\]
\[q_{out} = \frac{\Delta Vol}{t}\]


**** WRONG
Tank 1:
t = 15s
$Vol = \pi (4.5/2)^2 25$
$Vol = 0.000498m^3$

$q_{out,1} = 0.000498/15$
$q_{out,1} = 0.000027$

$C_d = $

Tank 2:
t = 20s
$Vol = \pi (4.5/2)^2 25$
$Vol = 0.000498m^3$

$q_{out,1} = 0.000498/20$
$q_{out,1} = 0.00002$

*** Tank Model
:DONE: Experimental:
This table was filled in using the code seen in :TODO: Appendix X NOTE: Copy code from matlab into appendix, just the functions
| Operating point (cm, V) | Step (Volts) | Final Value ($h_1 (t\rightarrow \infty)$) (cm) | Gain ($\frac{h_1(t\rightarrow \infty) - h_{1,0}}{V_P(t\rightarrow \infty) - V_{P,0}}$) (cm/V) | 2% Settling Time (seconds) |
| 4.2, 5                  | $-1V$        |                                           2.21 |                                                                                          2.03 |                       15.1 |
| 4.2, 5                  | $+1V$        |                                           6.12 |                                                                                          1.89 |                        8.9 |
| 6.7, 7                  | $-1V$        |                                           5.71 |                                                                                          1.11 |                       11.1 |
| 6.7, 7                  | $+1V$        |                                           7.76 |                                                                                          1.04 |                        8.9 |
| 8.5, 9                  | $-1V$        |                                           7.68 |                                                                                          0.90 |                       10.2 |
| 8.5, 9                  | $+1V$        |                                           9.53 |                                                                                          1.44 |                       23.0 |

:DONE: Non Linear Model:
| Operating point (cm, V) | Step (Volts) | Final Value ($h_1 (t\rightarrow \infty)$) (cm) | Gain ($\frac{h_1(t\rightarrow \infty) - h_{1,0}}{V_P(t\rightarrow \infty) - V_{P,0}}$) (cm/V) | 2% Settling Time (seconds) |
|                       5 | $-1V$        |                                   1.951205e+00 |                                                                                  1.053408e+00 |                         22 |
|                       5 | $1V$         |                                   4.258067e+00 |                                                                                  1.253454e+00 |                         24 |
|                       7 | $-1V$        |                                   4.410621e+00 |                                                                                  1.478420e+00 |                         26 |
|                       7 | $1V$         |                                   7.533171e+00 |                                                                                  1.644130e+00 |                         26 |
|                       9 | $-1V$        |                                   7.876880e+00 |                                                                                  1.858066e+00 |                         28 |
|                       9 | $1V$         |                                   1.173084e+01 |                                                                                  1.995890e+00 |                         28 |

:TODO: Linearised Model:
| Operating point (cm, V) | Step (Volts) | Final Value ($h_1 (t\rightarrow \infty)$) (cm) | Gain ($\frac{h_1(t\rightarrow \infty) - h_{1,0}}{V_P(t\rightarrow \infty) - V_{P,0}}$) (cm/V) | 2% Settling Time (seconds) |

:TODO: /Comment on differences between the non-linear and linearised model estimates and the observed response:/

:TODO: /a) Did you observe a difference in response for positive or negative input perturbations? Can you explain this?/
:TODO: /b) Explain any differences between nonlinear model and experimental?/
:DONE: /c) Would you expect the linearised model to fit the data worse if the step size was increased?/
We would expect the linearised model to perform worse with larger step sizes. This is because the linearised model works around a operating point, the further away from that point the less accurate the linear approximation works.


*** Coupled Tank Model
:TODO: Experimental:
| Operating point (cm, V) | Step (Volts) | Final Value ($h_1 (t\rightarrow \infty)$) (cm) | Gain ($\frac{h_1(t\rightarrow \infty) - h_{1,0}}{V_P(t\rightarrow \infty) - V_{P,0}}$) (cm/V) | 2% Settling Time (seconds) |
| 9.0, 5                  | $-1V$        |                                         6.8791 |                                                                                        2.4121 |                       23.4 |
| 9.0, 5                  | $+1V$        |                                        11.2303 |                                                                                        1.8601 |                       25.4 |
| 14.5, 7                 | $-1V$        |                                        11.9198 |                                                                                        2.7390 |                       17.9 |
| 14.5, 7                 | $+1V$        |                                        16.6517 |                                                                                        2.3749 |                        2.6 |
| 19.5, 9                 | $-1V$        |                                        17.7358 |                                                                                        2.4684 |                       13.3 |
| 19.5, 9                 | $+1V$        |                                        21.3884 |                                                                                        1.4476 |                       15.2 |

:TODO: Non Linear Model:
| Operating point (cm, V) | Step (Volts) | Final Value ($h_1 (t\rightarrow \infty)$) (cm) | Gain ($\frac{h_1(t\rightarrow \infty) - h_{1,0}}{V_P(t\rightarrow \infty) - V_{P,0}}$) (cm/V) | 2% Settling Time (seconds) |
|                       5 | $-1V$        |                                   5.171287e+00 |                                                                                  2.164194e+00 |                         38 |
|                       5 | $1V$         |                                   9.645496e+00 |                                                                                  2.310015e+00 |                         40 |
|                       7 | $-1V$        |                                   1.182028e+01 |                                                                                  2.557262e+00 |                         40 |
|                       7 | $1V$         |                                   1.694314e+01 |                                                                                  2.565595e+00 |                         40 |
|                       9 | $-1V$        |                                   2.106993e+01 |                                                                                  2.697029e+00 |                         40 |
|                       9 | $1V$         |                                   2.638299e+01 |                                                                                  2.616032e+00 |                         38 |

:TODO: Linearised Model:
| Operating point (cm, V) | Step (Volts) | Final Value ($h_1 (t\rightarrow \infty)$) (cm) | Gain ($\frac{h_1(t\rightarrow \infty) - h_{1,0}}{V_P(t\rightarrow \infty) - V_{P,0}}$) (cm/V) | 2% Settling Time (seconds) |



:TODO: /Comment on differences between the non-linear and linearised model estimates and the observed response:/
:TODO: /a) Did you observe a difference in response for positive or negative input perturbations? Can you explain this?/
:TODO: /b) Explain any differences between nonlinear model and experimental?/
:TODO: /c) Would you expect the linearised model to fit the data worse if the step size was increased?/
:TODO: /d) Is it possible for this system to exhibit overshoot?/

** Part 3 – Model Estimation
*** 1. From the empirical data in configuration #3 (previous table), estimate a 2nd order Laplace domain model for the plant at one of the operating points.
Using measured step response metrics
:TODO: /Selected operating point initial and final value for $V_P(t)$:/
:TODO: /Estimated gain $K$, damping factor $\zeta$, and natural frequency $\omega_n$:/
:TODO: /Estimated prototype second order transfer function:/

Using MATLAB’s Control Systems Toolbox system identification app
:TODO: /Selected operating point initial and final value for $V_P(t)$:/
:TODO: /Estimated gain $K$, damping factor $\zeta$, and natural frequency $\omega_n$:/
:TODO: /Estimated prototype second order transfer function:/

:TODO: /Comment on the differences between the empirical models, how well this fit the data, and any differences between the empirical estimation and that developed from theory./
*** 2. Use you empirical models to calculate the expected step response metrics (gain, settling time, rise time) at one of your other operating points for the same step size as applied in your Part 2 testing (as in previous table).

:TODO: /Selected operating point initial and final value for $V_p(t)$:/
:TODO: /Predicted step response metrics (gain, rise time, settling time) for each model at the selected operating point:/
:TODO: /How well do your empirical models generalise to different operating points or initial conditions?/


