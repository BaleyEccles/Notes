:PROPERTIES:
:ID:       e1293290-fe17-4467-8083-142aa848421e
:END:
#+title: State Space Representation
#+date: [2024-08-05 Mon 12:03]
#+STARTUP: latexpreview

* State Space Representation
"For [[id:240aca67-b15c-4bea-ba1e-09f80a59ccd5][Causel Systems]], the state at a point in time (\[n_0\]) is defined as the minimal information that is sufficent to determine the state and output of the system at all times \[n\geq n_0\], when the input to the system is also known for all times \[n\geq n_0\]".
The choise of state is not unique, that is there can be many ways to represent the same system.
These systems can be represented as [[id:6f242323-5b6b-469d-b611-a3cdf4641299][Block Diagrams]].

** State Space-Single Undelayed Input
State equation:
\[\begin{bmatrix}
q_{1}[n+1] \\
q_{2}[n+1] \\
\vdots     \\
q_{N}[n+1]
\end{bmatrix} = \begin{bmatrix}
0 & 1 & 0 & 0 & \hdots & 0 \\
0 & 0 & 1 & 0 & \hdots & 0 \\
0 & 0 & 0 & 1 & \hdots & 0 \\
\vdots & \vdots & \vdots & \vdots & \hdots & \vdots \\
0 & 0 & 0 & 0 & \hdots & 1 \\
-a_{N} & -a_{N-1} & -a_{N-2} & -a_{N-3} & \hdots & -a_{1}
\end{bmatrix} \begin{bmatrix}
q_{1}[n] \\
q_{2}[n] \\
\vdots   \\
q_{N}[n]
\end{bmatrix} + \begin{bmatrix}
0 \\
0 \\
\vdots \\
0 \\
b
\end{bmatrix} x[n]\]
and the output equation:
\[y[n] = \begin{bmatrix}
-a_{N} & -a_{N-1} & -a_{N-2} & \hdots & -a_{1}
\end{bmatrix} \begin{bmatrix}
q_{1}[n] \\
q_{2}[n] \\
\vdots   \\
q_{N}[n]
\end{bmatrix} + \begin{bmatrix}
b
\end{bmatrix} x[n] \]
Which becomes:
 - \[\underline{q}[n+1]=\underline{A}q[n]+\underline{b}x[n]\]
   - Part one of the general form
 - \[y[n]=\underline{C}q[n]+dx[n]\]
   - Part two of the general form
These equations can be used to solve systems of the form:
 - \[y[n]+a_1y[n-1]+a_2y[n-2]+ \hdots a_Ny[n-N]=bx[n]\]

** Solutions to State Space Equations
\[y[n]= \underline{c} \underline{A}^n q[0] + \sum_{k=0}^{n-1}\underline{c}\underline{A}^{n-1-k}\underline{b}x[k]+dx[n]\] for \[n>0\]
- The part before the sum is the zero input response
- The part after and includeing the sum is the zero state response
\[y[n]= \underline{c} q[0]+dx[0]\] for \[n=0\]
To solve this we need to know how to get [[id:e58c0264-f169-431a-a8ab-7d96365d9876][Matrix Powers]].
*** For Circuit Diagrams
Use the [[id:124ac03e-eb71-4731-a90c-55171f9edb80][Forward Difference]]
 - \[C \frac{dV_c}{dt}=i_c \Rightarrow C \frac{V_c[n+1]-V_c[n]}{T_s}=i_c[n]\]
   - \[V_c[n]=q_1[n]\]
 - \[L \frac{di_L}{dt}=V_L \Rightarrow L \frac{i_L[n+1]-i_L[n]}{T_s}=V_L[n]\]
   - \[i_L[n]=q_2[n]\]
Use KVL and KCL to solve for the general form of state space equations

** Stability
The system remains [[id:847ec0e7-da66-447a-9835-cd512492d2e3][BIBO Stable]] if the the [[id:e7ad3ee3-7394-40ed-b2a3-ca0815bd9280][Eigenvalues]] of \[\underline{A}^{n}\] are less then one
 - \[\lvert \lambda_{k} \rvert\ < 1 \forall k \in [1,N]\]
** Block Diagrams
We can form block diagrams by:

** Continuous Form
The first equation is:
 - \[\dot{\underline{x}} = A\underline{x} + B\underline{u}\]
   - $A$ is the system matrix
   - $B$ is the input matrix
The second equation is:
 - \[\underline{y} = C\underline{x} + D\underline{u}\]

*** Laplace To State Space
**** One Over Equation
[[xopp-pages:/home/baley/UTAS/org-roam/org-files/ENG331-Sate-Space-Laplace-Example-1.xopp]]
This will give a set of equations in phase-variable form
 - For $\dot{\underline{x}} = A\underline{x} + B\underline{u}$
   - The last row of the matrix $A$ is $-a_0,-a_1,\hdots,a_{n-1}$ with an identity matrix above it
   - $D$ is all zeros, but $b_0$ at the end
 - For $\underline{y} = C\underline{x} + D\underline{u}$
   - $C$ is 1 then all zeros
   - $D$ is all zeros

**** Equation Over Equation
Working:
 - \[\frac{C(s)}{R(s)} = \frac{N(s)}{D(s)}= \frac{b_2s^2 + b_1s + b_0}{a_3s^3 + a_2s^2 + a_1s + a_0} = G(s)\]
   - Order of $N(s)$ must be less than the order of $D(s)$
 - \[\begin{math} R(s) \rightarrow \framebox[1.1\width]{N(s)/D(s)} \rightarrow G(s)(t) \end{math}\]
 - \[\begin{math} R(s) \rightarrow \framebox[1.1\width]{1/D(s))} \rightarrow X(s) \rightarrow \framebox[1.1\width]{N(s)} \rightarrow G(s)(t) \end{math}\]
 - \[ C(s) = (b_2s^2 + b_1s + b_0)X(s)\]
 - \[\mathcal{L}^{-1}\{ C(s)\} = b_2\ddot{x}(t) + b_1\dot{x}(t) + b_0x(t)\]
 - \[\frac{X(s)}{R(s)} = X(s)\left[a_3^3 + a_2s^2 + a_1s a_0\right] = R(s)\]
 - \[\mathcal{L}^{-1}\{R(s)\} = a_3\dddot{x}(t) + a_2\ddot{x}(t) + a_1\dot{x}(t) a_0x(t)\right] = r(t)\]
 - \[\dddot{x}(t) = \frac{1}{a_{3}r(t) - \frac{a_0}{a_3}x(t) - \frac{a_1}{a_3}\dot{x}(t) - \frac{a_2}{a_3}\ddot{x}(t)\]
 - \[\underline{x} = \begin{bmatrix}x(t) \\ \dot{x}(t) \\ \ddot{x}(t)\end{bmatrix}\]
 - \[\underline{\dot{x}} = \begin{bmatrix}\dot{x}(t) \\ \ddot{x}(t) \\ \dddot{x}(t)\end{bmatrix}\]
 - \[\underline{u} = \begin{bmatrix}r(t)\end{bmatrix}\]
 - \[\underline{y} = \begin{bmatrix}c(t)\end{bmatrix}\]
 - \[\dot{x}(t) = \dot{x}(t)\]
 - \[\ddot{x}(t) = \ddot{x}(t)\]

Which means the equation:
 - For $\dot{\underline{x}} = A\underline{x} + B\underline{u}$
 - \[\begin{bmatrix} \dot{x}(t) \\ \ddot{x}(t) \\ \dddot{x}(t) \end{bmatrix} = \begin{bmatrix} 0 & 1 & 0 \\ 0 & 0 & 1 \\ \frac{-a_0}{a_3} & \frac{-a_1}{a_3} & \frac{-a_2}{a_3} \end{bmatrix} \begin{bmatrix} x(t) \\ \dot{x}(t) \\ \ddot{x}(t) \end{bmatrix} + \begin{bmatrix} 0 \\ 0 \\ \frac{1}{a_3} \end{bmatrix} r(t)\]
And
 - For $\underline{y} = C\underline{x} + D\underline{u}$
 - \[c(t) = \begin{bmatrix} b_0 & b_1 & b_2 \end{bmatrix} \begin{bmatrix} x(t) \\ \dot{x}(t) \\ \ddot{x}(t) \end{bmatrix} + \underline{0} r(t)\]

*** State Space To Laplace
These two equations:
 - \[\dot{\underline{x}} = A\underline{x} + B\underline{u}\]
 - \[\underline{y} = C\underline{x} + D\underline{u}\]
Become:
 - \[T(s) = \frac{Y(s)}{U(s)} = C(sI - A)^{-1}B + D\]

**** Example
 - \[\underline{\dot{x}} = \begin{bmatrix} -4 & -1.5  \\ 4 & 0 \end{bmatrix} \underline{x} + \begin{bmatrix} 2 \\ 0 \end{bmatrix} r(t)\]
 - \[\underline{y} = \begin{bmatrix} 1.5 & 0.625 \end{bmatrix} \underline{x} + 0 u(t)\]
   
 - \[(sI - A) = \begin{bmatrix} s + 4 & 1.5 \\ -4 & s\end{bmatrix}\]
 - \[(sI - A)^{-1} = \frac{\textrm{adj}(sI-A)}{\det(sI-A)} = \frac{\begin{bmatrix} s & 4 \\ -1.5 & s + 4\end{bmatrix}}{(s+4)s - 1.5\cdot(-4)}\]
 - \[= \frac{1}{s^2 + 4s + 6}\begin{bmatrix} s & 4 \\ -1.5 & s + 4\end{bmatrix}\]
   
 - \[C(sI - A)^{-1}B = \frac{1}{s^2 + 4s + 6}\begin{bmatrix}1.5 & 0.625\end{bmatrix}\begin{bmatrix} s & 4 \\ -1.5 & s + 4\end{bmatrix}\begin{bmatrix} 0 \\ 2\end{bmatrix}\]
 - \[= \frac{3s + 5}{s^2 + 4s +6} = T(s)\]



